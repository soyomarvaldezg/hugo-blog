<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Pregunta #15 - Particionamiento de Datos en S3 | Omar Valdez G</title><meta name=keywords content="s3,partitioning,buckets"><meta name=description content="Evita el anti-patr√≥n que ralentiza tus queries en 20√ó"><meta name=author content="Omar Valdez G"><link rel=canonical href=http://localhost:1313/posts/q-particionamiento-datos-s3/><link crossorigin=anonymous href=/assets/css/stylesheet.41163b9ab2122008ead4e34b52cda72444f0291450b642c1db4b84cc26f2863d.css integrity="sha256-QRY7mrISIAjq1ONLUs2nJETwKRRQtkLB20uEzCbyhj0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/q-particionamiento-datos-s3/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet><script src=https://unpkg.com/typeit@8.7.1/dist/index.umd.js></script><style>body{font-family:iosevka nerd font bold,monospace}</style><meta property="og:title" content="Pregunta #15 - Particionamiento de Datos en S3"><meta property="og:description" content="Evita el anti-patr√≥n que ralentiza tus queries en 20√ó"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/q-particionamiento-datos-s3/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-18T00:00:00+00:00"><meta property="og:site_name" content="Omar Valdez G"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pregunta #15 - Particionamiento de Datos en S3"><meta name=twitter:description content="Evita el anti-patr√≥n que ralentiza tus queries en 20√ó"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Pregunta #15 - Particionamiento de Datos en S3","item":"http://localhost:1313/posts/q-particionamiento-datos-s3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Pregunta #15 - Particionamiento de Datos en S3","name":"Pregunta #15 - Particionamiento de Datos en S3","description":"Evita el anti-patr√≥n que ralentiza tus queries en 20√ó","keywords":["s3","partitioning","buckets"],"articleBody":"Contexto: Imagina que tu equipo de data engineering procesa 5 a√±os de eventos de usuario almacenados en S3, consultados principalmente con Athena para an√°lisis de tendencias mensuales y trimestrales.\nPREGUNTA Tu equipo necesita optimizar queries que frecuentemente consultan rangos de fechas como ‚Äú√∫ltimos 90 d√≠as‚Äù o ‚ÄúQ3 2024 a Q1 2025‚Äù en un data lake con millones de registros diarios en S3.\nEl data engineer senior propone reestructurar las particiones porque las queries actuales tardan 20√ó m√°s de lo esperado.\nActualmente usan una estructura heredada de sistemas on-premise.\n¬øQu√© estructura de particionamiento deber√≠as implementar para optimizar performance de queries con rangos de fechas?\nA) s3://bucket/data/region=us/year=2025/month=01/day=15/events.parquet B) s3://bucket/data/user_id={id}/timestamp={epoch}/events.parquet C) s3://bucket/data/dt=2025-01-15/events.parquet D) s3://bucket/data/year_month=2025_01/day=15/events.parquet RESPUESTA: C\nEXPLICACI√ìN La opci√≥n C usa formato ISO 8601 en una sola columna de partici√≥n (dt=YYYY-MM-DD), permitiendo queries de rango simples como WHERE dt \u003e= ‚Äò2024-10-01‚Äô AND dt \u003c= ‚Äò2025-01-15‚Äô.\nEste enfoque aprovecha el ordenamiento alfab√©tico natural de las fechas ISO y permite partition pruning eficiente con un solo predicado.\nLa opci√≥n A (a√±o/mes/d√≠a anidado) es el anti-patr√≥n cl√°sico heredado de HDFS. Para consultar 100 d√≠as necesitas generar 100+ cl√°usulas OR: WHERE (year=‚Äô2024‚Äô AND month=‚Äô10‚Äô AND day=‚Äô01‚Äô) OR (year=‚Äô2024‚Äô AND month=‚Äô10‚Äô AND day=‚Äô02‚Äô) OR‚Ä¶ llegando a l√≠mites de longitud de query en Athena. Adem√°s, S3 no tiene metadata centralizada como HDFS NameNode‚Äîcada partici√≥n requiere llamadas LIST API separadas, causando overhead masivo.\nLa opci√≥n B particiona por alta cardinalidad (user_id), generando millones de particiones min√∫sculas con overhead de metadata insostenible.\nLa opci√≥n D mezcla conceptos sin resolver el problema fundamental de queries de rango.\nEJEMPLO REAL El equipo de OLake enfrent√≥ queries 20√ó m√°s lentas con 110,000 particiones usando estructura year/month/day.\nMiles de llamadas a S3 LIST API para metadata convert√≠an queries simples en pesadillas operativas.\nAl migrar a dt=2020-12-01 con ISO 8601, redujeron dr√°sticamente el conteo de particiones y eliminaron la complejidad de queries‚Äîun rango de 30 d√≠as pas√≥ de requerir 30 cl√°usulas OR complejas a un simple predicado de dos l√≠mites.\nCONSEJO CLAVE Usa dt=YYYY-MM-DD como default para cualquier data lake en S3, no importa que ‚ÄúHive lo hace diferente‚Äù‚ÄîS3 no es HDFS.\nMonitorea el conteo total de particiones: si ves 100k+ particiones para vol√∫menes razonables de datos, tu estrategia est√° equivocada.\nApunta a particiones de 100 MB a pocos GB balanceando paralelismo contra overhead de metadata.\nREFERENCIAS https://olake.io/iceberg/data-partitioning-in-s3 - OLake: Data Partitioning in AWS S3 (Feb 2025) https://eagleeyet.net/blog/cloud/avoiding-the-s3-partition-trap-smarter-strategies-for-structuring-your-data-lake/ - S3 Partition Best Practices (Nov 2025) https://aws.amazon.com/blogs/big-data/get-started-managing-partitions-for-amazon-s3-tables-backed-by-the-aws-glue-data-catalog/ - AWS: Managing Partitions for S3 Tables (Jun 2023) ","wordCount":"409","inLanguage":"en","datePublished":"2025-12-18T00:00:00Z","dateModified":"2025-12-18T00:00:00Z","author":{"@type":"Person","name":"Omar Valdez G"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/q-particionamiento-datos-s3/"},"publisher":{"@type":"Organization","name":"Omar Valdez G","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="~$ cd .. (Alt + H)"><img src=http://localhost:1313/favicon/favicon.ico alt aria-label=logo height=35>~$ cd ..</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title=üîé><span>üîé</span></a></li><li><a href=http://localhost:1313/dotfiles/ title="‚Ä¢ dots"><span>‚Ä¢ dots</span></a></li><li><a href=http://localhost:1313/tags/ title="‚Ä¢ tags"><span>‚Ä¢ tags</span></a></li><li><a href=http://localhost:1313/newsletter title="‚Ä¢ newsletter"><span>‚Ä¢ newsletter</span></a></li><li><a href=http://localhost:1313/posts/ title="‚Ä¢ posts"><span>‚Ä¢ posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Pregunta #15 - Particionamiento de Datos en S3</h1><div class=post-meta></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pregunta aria-label=PREGUNTA>PREGUNTA</a></li><li><a href=#explicaci%c3%b3n aria-label=EXPLICACI√ìN>EXPLICACI√ìN</a></li><li><a href=#ejemplo-real aria-label="EJEMPLO REAL">EJEMPLO REAL</a></li><li><a href=#consejo-clave aria-label="CONSEJO CLAVE">CONSEJO CLAVE</a></li><li><a href=#referencias aria-label=REFERENCIAS>REFERENCIAS</a></li></ul></div></details></div><div class=post-content><p><em><strong>Contexto</strong>: Imagina que tu equipo de data engineering procesa 5 a√±os de eventos de usuario almacenados en S3, consultados principalmente con Athena para an√°lisis de tendencias mensuales y trimestrales.</em></p><h3 id=pregunta>PREGUNTA<a hidden class=anchor aria-hidden=true href=#pregunta>#</a></h3><p>Tu equipo necesita optimizar queries que frecuentemente consultan rangos de fechas como ‚Äú√∫ltimos 90 d√≠as‚Äù o ‚ÄúQ3 2024 a Q1 2025‚Äù en un data lake con millones de registros diarios en S3.</p><p>El data engineer senior propone reestructurar las particiones porque las queries actuales tardan 20√ó m√°s de lo esperado.</p><p>Actualmente usan una estructura heredada de sistemas on-premise.</p><p><strong>¬øQu√© estructura de particionamiento deber√≠as implementar para optimizar performance de queries con rangos de fechas?</strong></p><p>¬†</p><ul><li>A) s3://bucket/data/region=us/year=2025/month=01/day=15/events.parquet</li><li>B) s3://bucket/data/user_id={id}/timestamp={epoch}/events.parquet</li><li>C) s3://bucket/data/dt=2025-01-15/events.parquet</li><li>D) s3://bucket/data/year_month=2025_01/day=15/events.parquet</li></ul><p>¬†</p><p><strong>RESPUESTA: C</strong></p><h3 id=explicaci√≥n>EXPLICACI√ìN<a hidden class=anchor aria-hidden=true href=#explicaci√≥n>#</a></h3><p>La opci√≥n C usa formato ISO 8601 en una sola columna de partici√≥n (dt=YYYY-MM-DD), permitiendo queries de rango simples como WHERE dt >= ‚Äò2024-10-01‚Äô AND dt &lt;= ‚Äò2025-01-15‚Äô.</p><p>Este enfoque aprovecha el ordenamiento alfab√©tico natural de las fechas ISO y permite partition pruning eficiente con un solo predicado.</p><p>La opci√≥n A (a√±o/mes/d√≠a anidado) es el anti-patr√≥n cl√°sico heredado de HDFS. Para consultar 100 d√≠as necesitas generar 100+ cl√°usulas OR: WHERE (year=‚Äô2024‚Äô AND month=‚Äô10‚Äô AND day=‚Äô01‚Äô) OR (year=‚Äô2024‚Äô AND month=‚Äô10‚Äô AND day=‚Äô02‚Äô) OR&mldr; llegando a l√≠mites de longitud de query en Athena. Adem√°s, S3 no tiene metadata centralizada como HDFS NameNode‚Äîcada partici√≥n requiere llamadas LIST API separadas, causando overhead masivo.</p><p>La opci√≥n B particiona por alta cardinalidad (user_id), generando millones de particiones min√∫sculas con overhead de metadata insostenible.</p><p>La opci√≥n D mezcla conceptos sin resolver el problema fundamental de queries de rango.</p><h3 id=ejemplo-real>EJEMPLO REAL<a hidden class=anchor aria-hidden=true href=#ejemplo-real>#</a></h3><p>El equipo de OLake enfrent√≥ queries 20√ó m√°s lentas con 110,000 particiones usando estructura year/month/day.</p><p>Miles de llamadas a S3 LIST API para metadata convert√≠an queries simples en pesadillas operativas.</p><p>Al migrar a dt=2020-12-01 con ISO 8601, redujeron dr√°sticamente el conteo de particiones y eliminaron la complejidad de queries‚Äîun rango de 30 d√≠as pas√≥ de requerir 30 cl√°usulas OR complejas a un simple predicado de dos l√≠mites.</p><h3 id=consejo-clave>CONSEJO CLAVE<a hidden class=anchor aria-hidden=true href=#consejo-clave>#</a></h3><p>Usa dt=YYYY-MM-DD como default para cualquier data lake en S3, no importa que ‚ÄúHive lo hace diferente‚Äù‚ÄîS3 no es HDFS.</p><p>Monitorea el conteo total de particiones: si ves 100k+ particiones para vol√∫menes razonables de datos, tu estrategia est√° equivocada.</p><p>Apunta a particiones de 100 MB a pocos GB balanceando paralelismo contra overhead de metadata.</p><h3 id=referencias>REFERENCIAS<a hidden class=anchor aria-hidden=true href=#referencias>#</a></h3><ul><li><a href=https://olake.io/iceberg/data-partitioning-in-s3>https://olake.io/iceberg/data-partitioning-in-s3</a> - OLake: Data Partitioning in AWS S3 (Feb 2025)</li><li><a href=https://eagleeyet.net/blog/cloud/avoiding-the-s3-partition-trap-smarter-strategies-for-structuring-your-data-lake/>https://eagleeyet.net/blog/cloud/avoiding-the-s3-partition-trap-smarter-strategies-for-structuring-your-data-lake/</a> - S3 Partition Best Practices (Nov 2025)</li><li><a href=https://aws.amazon.com/blogs/big-data/get-started-managing-partitions-for-amazon-s3-tables-backed-by-the-aws-glue-data-catalog/>https://aws.amazon.com/blogs/big-data/get-started-managing-partitions-for-amazon-s3-tables-backed-by-the-aws-glue-data-catalog/</a> - AWS: Managing Partitions for S3 Tables (Jun 2023)</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/s3/>S3</a></li><li><a href=http://localhost:1313/tags/partitioning/>Partitioning</a></li><li><a href=http://localhost:1313/tags/buckets/>Buckets</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/q-busqueda-semantica-keywords/><span class=title>¬´ Prev</span><br><span>Pregunta #14 - B√∫squeda Sem√°ntica vs Keywords</span>
</a><a class=next href=http://localhost:1313/posts/q-infra-datos-para-ia/><span class=title>Next ¬ª</span><br><span>Pregunta #16 - Infraestructura de Datos para IA</span></a></nav><div class=newsletter-wrapper><script async src=https://eocampaign1.com/form/0d56db8e-de34-11f0-9838-c955fe4b6ecd.js data-form=0d56db8e-de34-11f0-9838-c955fe4b6ecd></script></div><div id=cusdis_thread data-host=https://cusdis.com data-app-id=f9b750aa-55fe-4da9-82cf-45aa511cea20 data-app-id=414adb98-9af8-4403-bdc5-ba55ae808bea data-page-id=868d17e19fc9b6d389a8bf1bccb4325d data-page-url=http://localhost:1313/posts/q-particionamiento-datos-s3/ data-page-title="Pregunta #15 - Particionamiento de Datos en S3"></div><script async defer src=https://cusdis.com/js/cusdis.es.js></script></footer></article></main><script async defer src=https://scripts.withcabin.com/hello.js></script></body></html>