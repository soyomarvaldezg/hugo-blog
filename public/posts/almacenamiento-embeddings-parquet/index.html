<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet | Omar Valdez G</title><meta name=keywords content="database,rag,vectorial"><meta name=description content="¬øCu√°ndo necesitas realmente una base de datos vectorial?"><meta name=author content="Omar Valdez G"><link rel=canonical href=http://localhost:1313/posts/almacenamiento-embeddings-parquet/><link crossorigin=anonymous href=/assets/css/stylesheet.098c413488605d1532e70aee11c86f3752a3892cc096ba30d2d3d8a85384b054.css integrity="sha256-CYxBNIhgXRUy5wruEchvN1KjiSzAlrow0tPYqFOEsFQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/almacenamiento-embeddings-parquet/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet><script src=https://unpkg.com/typeit@8.7.1/dist/index.umd.js></script><style>body{font-family:iosevka nerd font bold,monospace}</style><meta property="og:title" content="Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet"><meta property="og:description" content="¬øCu√°ndo necesitas realmente una base de datos vectorial?"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/almacenamiento-embeddings-parquet/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-19T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-19T00:00:00+00:00"><meta property="og:site_name" content="Omar Valdez G"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet"><meta name=twitter:description content="¬øCu√°ndo necesitas realmente una base de datos vectorial?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet","item":"http://localhost:1313/posts/almacenamiento-embeddings-parquet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet","name":"Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet","description":"¬øCu√°ndo necesitas realmente una base de datos vectorial?","keywords":["database","rag","vectorial"],"articleBody":"Contexto: En proyectos de b√∫squeda sem√°ntica y RAG, muchos equipos asumen que necesitan bases de datos vectoriales especializadas desde el inicio, sin considerar alternativas m√°s simples para conjuntos de datos peque√±os y medianos.\nPREGUNTA Est√°s desarrollando un sistema de b√∫squeda sem√°ntica para documentaci√≥n interna de tu empresa con aproximadamente 25,000 art√≠culos. Ya generaste embeddings de 768 dimensiones usando un modelo BERT y necesitas decidir c√≥mo almacenarlos. El equipo de infraestructura est√° preocupado por los costos operativos, pero el equipo de producto requiere latencias sub-5ms para b√∫squedas con filtros por categor√≠a y fecha. Tu arquitectura debe ser portable entre ambientes de desarrollo local y producci√≥n en AWS.\n¬øCu√°l es el enfoque m√°s apropiado para este escenario?\nA) Implementar Qdrant con √≠ndices HNSW en Docker, priorizando latencia sub-1ms sobre simplicidad operativa\nB) Usar archivos Parquet con Polars para b√∫squeda lineal, aprovechando el formato columnar y conversi√≥n zero-copy a NumPy\nC) Almacenar embeddings en PostgreSQL con extensi√≥n pgvector y √≠ndices HNSW para obtener 471 QPS a escala\nD) Guardar embeddings en archivos CSV con pandas por familiaridad del equipo y facilidad de debugging\nRESPUESTA: B\nEXPLICACI√ìN La opci√≥n B es correcta porque 25,000 vectores con 768 dimensiones ocupan aproximadamente 73MB en memoria (25k √ó 768 √ó 4 bytes), un tama√±o manejable donde la b√∫squeda lineal alcanza latencias de 1-2ms seg√∫n benchmarks reales.\nParquet ofrece compresi√≥n 6x superior a CSV, soporte nativo para arrays tipados como List(Float32), y acceso columnar selectivo que permite cargar solo embeddings y metadatos necesarios.\nPolars proporciona conversi√≥n zero-copy a NumPy para operaciones vectorizadas de producto punto, eliminando overhead de serializaci√≥n manual. Este enfoque cumple el requisito de sub-5ms, evita complejidad de Docker/configuraci√≥n, y mantiene portabilidad perfecta mediante un √∫nico archivo.\nPor qu√© las otras opciones fallan:‚Äã\nLas opciones A y C son sobre-ingenier√≠a prematura: bases de datos vectoriales con HNSW se justifican despu√©s de ~100k vectores donde b√∫squeda lineal O(n) se vuelve prohibitiva.\nLa opci√≥n D es ineficiente: CSV consume 6x m√°s espacio, requiere parsing completo del archivo, carece de tipos para arrays anidados, y pandas trata listas como objetos gen√©ricos con penalizaciones severas de rendimiento versus el soporte nativo de Polars para pl.List.\nEJEMPLO REAL El proyecto Magic: The Gathering implement√≥ b√∫squeda sobre 32,254 cartas con embeddings de 768D usando esta arquitectura exacta, logrando queries filtradas por metadatos en 1.48ms.\nEl sistema permite b√∫squedas sem√°nticas complejas como ‚Äúcartas similares a Lightning Helix pero solo Sorceries con mana Black‚Äù aplicando filtros de Polars antes de calcular similitud coseno mediante producto punto en NumPy.\nTodo funciona desde un archivo Parquet portable sin infraestructura de base de datos, demostrando que 94MB de embeddings (32k √ó 768 √ó 4 bytes) operan perfectamente en memoria de laptops modernas con latencias aceptables para usuarios finales.\nCONSEJO CLAVE Benchmarkea tu caso de uso real antes de adoptar bases de datos vectoriales. La regla pr√°ctica es: si tu dataset completo cabe en memoria (~100k vectores o menos), b√∫squeda lineal con Parquet+Polars ofrece latencias sub-2ms sin overhead operacional.\nPre-normaliza embeddings a longitud unitaria durante almacenamiento para convertir similitud coseno en simple producto punto, acelerando queries significativamente.\nSolo escala a soluciones indexadas (HNSW/IVF) cuando datasets excedan 100k vectores o necesites consultas distribuidas.\nREFERENCIAS Almacenamiento port√°til de embeddings con Parquet y Polars - minimaxir.com Formato columnar Parquet: beneficios y mejores pr√°cticas - Airbyte Interoperabilidad zero-copy entre Polars y NumPy - Polars Blog ","wordCount":"553","inLanguage":"en","datePublished":"2025-11-19T00:00:00Z","dateModified":"2025-11-19T00:00:00Z","author":{"@type":"Person","name":"Omar Valdez G"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/almacenamiento-embeddings-parquet/"},"publisher":{"@type":"Organization","name":"Omar Valdez G","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="~$ cd .. (Alt + H)"><img src=http://localhost:1313/favicon/favicon.ico alt aria-label=logo height=35>~$ cd ..</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title="üîé search"><span>üîé search</span></a></li><li><a href=http://localhost:1313/dotfiles/ title="‚Ä¢ dotfiles"><span>‚Ä¢ dotfiles</span></a></li><li><a href=http://localhost:1313/tags/ title="‚Ä¢ tags"><span>‚Ä¢ tags</span></a></li><li><a href=http://localhost:1313/posts/ title="‚Ä¢ posts"><span>‚Ä¢ posts</span></a></li><li><a href=https://withcabin.com/privacy/soyomarvaldezg.xyz title="‚Ä¢ cabin"><span>‚Ä¢ cabin</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet</h1><div class=post-meta></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pregunta aria-label=PREGUNTA>PREGUNTA</a></li><li><a href=#explicaci%c3%b3n aria-label=EXPLICACI√ìN>EXPLICACI√ìN</a></li><li><a href=#ejemplo-real aria-label="EJEMPLO REAL">EJEMPLO REAL</a></li><li><a href=#consejo-clave aria-label="CONSEJO CLAVE">CONSEJO CLAVE</a></li><li><a href=#referencias aria-label=REFERENCIAS>REFERENCIAS</a></li></ul></div></details></div><div class=post-content><p><em><strong>Contexto</strong>: En proyectos de b√∫squeda sem√°ntica y RAG, muchos equipos asumen que necesitan bases de datos vectoriales especializadas desde el inicio, sin considerar alternativas m√°s simples para conjuntos de datos peque√±os y medianos.</em></p><h1 id=pregunta>PREGUNTA<a hidden class=anchor aria-hidden=true href=#pregunta>#</a></h1><p>Est√°s desarrollando un sistema de b√∫squeda sem√°ntica para documentaci√≥n interna de tu empresa con aproximadamente 25,000 art√≠culos. Ya generaste embeddings de 768 dimensiones usando un modelo BERT y necesitas decidir c√≥mo almacenarlos. El equipo de infraestructura est√° preocupado por los costos operativos, pero el equipo de producto requiere latencias sub-5ms para b√∫squedas con filtros por categor√≠a y fecha. Tu arquitectura debe ser portable entre ambientes de desarrollo local y producci√≥n en AWS.</p><p><strong>¬øCu√°l es el enfoque m√°s apropiado para este escenario?</strong></p><p>¬†</p><p>A) Implementar Qdrant con √≠ndices HNSW en Docker, priorizando latencia sub-1ms sobre simplicidad operativa</p><p>B) Usar archivos Parquet con Polars para b√∫squeda lineal, aprovechando el formato columnar y conversi√≥n zero-copy a NumPy</p><p>C) Almacenar embeddings en PostgreSQL con extensi√≥n pgvector y √≠ndices HNSW para obtener 471 QPS a escala</p><p>D) Guardar embeddings en archivos CSV con pandas por familiaridad del equipo y facilidad de debugging</p><p>¬†</p><p><strong>RESPUESTA: B</strong></p><h1 id=explicaci√≥n>EXPLICACI√ìN<a hidden class=anchor aria-hidden=true href=#explicaci√≥n>#</a></h1><p>La opci√≥n B es correcta porque 25,000 vectores con 768 dimensiones ocupan aproximadamente 73MB en memoria (25k √ó 768 √ó 4 bytes), un tama√±o manejable donde la b√∫squeda lineal alcanza latencias de 1-2ms seg√∫n benchmarks reales.</p><p>Parquet ofrece compresi√≥n 6x superior a CSV, soporte nativo para arrays tipados como List(Float32), y acceso columnar selectivo que permite cargar solo embeddings y metadatos necesarios.</p><p>Polars proporciona conversi√≥n zero-copy a NumPy para operaciones vectorizadas de producto punto, eliminando overhead de serializaci√≥n manual. Este enfoque cumple el requisito de sub-5ms, evita complejidad de Docker/configuraci√≥n, y mantiene portabilidad perfecta mediante un √∫nico archivo.</p><p>Por qu√© las otras opciones fallan:‚Äã</p><p>Las opciones A y C son sobre-ingenier√≠a prematura: bases de datos vectoriales con HNSW se justifican despu√©s de ~100k vectores donde b√∫squeda lineal O(n) se vuelve prohibitiva.</p><p>La opci√≥n D es ineficiente: CSV consume 6x m√°s espacio, requiere parsing completo del archivo, carece de tipos para arrays anidados, y pandas trata listas como objetos gen√©ricos con penalizaciones severas de rendimiento versus el soporte nativo de Polars para pl.List.</p><h1 id=ejemplo-real>EJEMPLO REAL<a hidden class=anchor aria-hidden=true href=#ejemplo-real>#</a></h1><p>El proyecto Magic: The Gathering implement√≥ b√∫squeda sobre 32,254 cartas con embeddings de 768D usando esta arquitectura exacta, logrando queries filtradas por metadatos en 1.48ms.</p><p>El sistema permite b√∫squedas sem√°nticas complejas como ‚Äúcartas similares a Lightning Helix pero solo Sorceries con mana Black‚Äù aplicando filtros de Polars antes de calcular similitud coseno mediante producto punto en NumPy.</p><p>Todo funciona desde un archivo Parquet portable sin infraestructura de base de datos, demostrando que 94MB de embeddings (32k √ó 768 √ó 4 bytes) operan perfectamente en memoria de laptops modernas con latencias aceptables para usuarios finales.</p><h1 id=consejo-clave>CONSEJO CLAVE<a hidden class=anchor aria-hidden=true href=#consejo-clave>#</a></h1><p>Benchmarkea tu caso de uso real antes de adoptar bases de datos vectoriales. La regla pr√°ctica es: si tu dataset completo cabe en memoria (~100k vectores o menos), b√∫squeda lineal con Parquet+Polars ofrece latencias sub-2ms sin overhead operacional.</p><p>Pre-normaliza embeddings a longitud unitaria durante almacenamiento para convertir similitud coseno en simple producto punto, acelerando queries significativamente.</p><p>Solo escala a soluciones indexadas (HNSW/IVF) cuando datasets excedan 100k vectores o necesites consultas distribuidas.</p><h1 id=referencias>REFERENCIAS<a hidden class=anchor aria-hidden=true href=#referencias>#</a></h1><ul><li><a href=https://minimaxir.com/2025/02/embeddings-parquet/>Almacenamiento port√°til de embeddings con Parquet y Polars - minimaxir.com</a></li><li><a href=https://airbyte.com/data-engineering-resources/parquet-data-format>Formato columnar Parquet: beneficios y mejores pr√°cticas - Airbyte</a></li><li><a href=https://pola.rs/posts/polars-in-aggregate-mar24/>Interoperabilidad zero-copy entre Polars y NumPy - Polars Blog</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/database/>Database</a></li><li><a href=http://localhost:1313/tags/rag/>Rag</a></li><li><a href=http://localhost:1313/tags/vectorial/>Vectorial</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/arq-orquestacion-task-data/><span class=title>¬´ Prev</span><br><span>Pregunta #3 - Arquitecturas de Orquestaci√≥n: Task-Centric vs Data-Centric</span></a></nav><div id=cusdis_thread data-host=https://cusdis.com data-app-id=f9b750aa-55fe-4da9-82cf-45aa511cea20 data-app-id=414adb98-9af8-4403-bdc5-ba55ae808bea data-page-id=7ab4ee1ec57b9e26f8f61403c477a754 data-page-url=http://localhost:1313/posts/almacenamiento-embeddings-parquet/ data-page-title="Pregunta #4 - Almacenamiento Port√°til de Embeddings con Parquet"></div><script async defer src=https://cusdis.com/js/cusdis.es.js></script></footer></article></main><script async defer src=https://scripts.withcabin.com/hello.js></script></body></html>