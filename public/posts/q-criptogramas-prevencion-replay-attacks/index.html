<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks | Omar Valdez G</title><meta name=keywords content=",,"><meta name=description content="Arquitectura de Seguridad en Sistemas de Pago M√≥vil"><meta name=author content="Omar Valdez G"><link rel=canonical href=http://localhost:1313/posts/q-criptogramas-prevencion-replay-attacks/><link crossorigin=anonymous href=/assets/css/stylesheet.d8bb4da40dcec890935558078b7b18d1baf46e84a80ea4cc9702a8734954dbff.css integrity="sha256-2LtNpA3OyJCTVVgHi3sY0br0boSoDqTMlwKoc0lU2/8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/q-criptogramas-prevencion-replay-attacks/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet><script src=https://unpkg.com/typeit@8.7.1/dist/index.umd.js></script><style>body{font-family:iosevka nerd font bold,monospace}</style><meta property="og:title" content="Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks"><meta property="og:description" content="Arquitectura de Seguridad en Sistemas de Pago M√≥vil"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/q-criptogramas-prevencion-replay-attacks/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-09T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-09T00:00:00+00:00"><meta property="og:site_name" content="Omar Valdez G"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks"><meta name=twitter:description content="Arquitectura de Seguridad en Sistemas de Pago M√≥vil"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks","item":"http://localhost:1313/posts/q-criptogramas-prevencion-replay-attacks/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks","name":"Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks","description":"Arquitectura de Seguridad en Sistemas de Pago M√≥vil","keywords":["","",""],"articleBody":"Contexto: Los sistemas de pago digital procesan millones de transacciones diarias donde un atacante podr√≠a interceptar datos v√°lidos y reutilizarlos para compras fraudulentas. Apple Pay procesa 41 millones de transacciones diarias usando criptogramas din√°micos que previenen estos ataques.\nPREGUNTA Est√°s dise√±ando un sistema de pagos m√≥viles para una plataforma de e-commerce. Durante una revisi√≥n de seguridad, tu equipo identifica que un atacante podr√≠a capturar solicitudes NFC v√°lidas y reproducirlas para realizar compras no autorizadas.\nNecesitas implementar una soluci√≥n que genere pruebas criptogr√°ficas √∫nicas por transacci√≥n.\n¬øCu√°l es la arquitectura m√°s efectiva para prevenir replay attacks manteniendo capacidad offline?\nA) Generar un hash SHA-256 del Device Account Number (DAN) y enviarlo en cada transacci√≥n junto con un timestamp del servidor\nB) Crear un criptograma √∫nico combinando DAN + detalles de transacci√≥n (monto, merchant ID) + nonce impredecible, validado matem√°ticamente por la red de pagos\nC) Implementar tokens JWT con expiraci√≥n de 5 minutos firmados con clave sim√©trica compartida entre dispositivo y servidor\nD) Almacenar un contador incremental en el dispositivo que se valida contra una base de datos centralizada en cada transacci√≥n\nRESPUESTA: B\nEXPLICACI√ìN La opci√≥n B implementa el patr√≥n de Per-Transaction Cryptographic Signature que Apple Pay utiliza exitosamente.\nEl criptograma combina tres elementos cr√≠ticos: el DAN (token espec√≠fico del dispositivo almacenado en Secure Element), detalles de la transacci√≥n (monto, merchant ID) y un nonce impredecible generado por el terminal de punto de venta.\nEsta combinaci√≥n genera una firma criptogr√°fica √∫nica que solo es v√°lida para esa transacci√≥n espec√≠fica.\nLa red de pagos regenera el criptograma usando su copia del DAN y los mismos par√°metros; si coinciden, la transacci√≥n es leg√≠tima.\nSi un atacante captura el criptograma e intenta replicarlo, la validaci√≥n falla porque el nonce o el monto habr√°n cambiado.\nEste dise√±o funciona completamente offline porque toda la generaci√≥n criptogr√°fica ocurre localmente en el dispositivo usando claves pre-establecidas\nLas otras opciones tienen vulnerabilidades cr√≠ticas:\nA depende de timestamps del servidor (requiere conectividad, vulnerable a desincronizaci√≥n de relojes) y un simple hash es insuficiente sin elementos √∫nicos por transacci√≥n. C requiere conectividad de red para validar JWT y tokens de 5 minutos permiten ventana de replay. D necesita acceso constante a base de datos centralizada, eliminando capacidad offline y creando punto √∫nico de falla. EJEMPLO REAL Cuando un usuario tapa su iPhone en el metro de Londres sin conexi√≥n a internet, el Secure Element genera un criptograma combinando el DAN almacenado localmente, los ¬£10 del viaje, el merchant ID del sistema de transporte, y el nonce enviado por el terminal.\nEste criptograma se transmite v√≠a NFC al lector. Posteriormente, cuando el terminal recupera conectividad, env√≠a el criptograma a Visa para validaci√≥n.\nVisa regenera el criptograma usando su copia del DAN y los mismos par√°metros de transacci√≥n; si coinciden matem√°ticamente, aprueba el pago.\nSi un atacante intercept√≥ ese criptograma e intenta reusarlo, la validaci√≥n falla instant√°neamente porque el nonce ha cambiado o el timestamp es obsoleto.\nCONSEJO CLAVE En sistemas de alta seguridad, nunca conf√≠es en un solo mecanismo de protecci√≥n. Implementa defensa en profundidad combinando tokenizaci√≥n (reemplazar secretos), aislamiento de hardware (Secure Element para claves), y validaci√≥n criptogr√°fica por transacci√≥n.\nEste enfoque multicapa garantiza que comprometer un componente no expone todo el sistema.\nPara APIs de pago, siempre incluye elementos impredecibles (nonces) y espec√≠ficos de contexto (monto, timestamp) en tus firmas criptogr√°ficas.\nREFERENCIAS https://www.frugaltesting.com/blog/is-apple-pay-secure-how-apple-ensures-top-tier-security-for-digital-payments - Frugal Testing - Apple Pay Security Architecture: Tokenization \u0026 Dynamic Cryptograms https://newsletter.systemdesign.one/p/how-does-apple-pay-work - System Design Newsletter - How Apple Pay Handles 41 Million Transactions Securely https://docs.nuvei.com/documentation/features/network-tokenization/ - Nuvei Documentation - Network Tokenization \u0026 Cryptogram Requirements ","wordCount":"590","inLanguage":"en","datePublished":"2025-12-09T00:00:00Z","dateModified":"2025-12-09T00:00:00Z","author":{"@type":"Person","name":"Omar Valdez G"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/q-criptogramas-prevencion-replay-attacks/"},"publisher":{"@type":"Organization","name":"Omar Valdez G","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="~$ cd .. (Alt + H)"><img src=http://localhost:1313/favicon/favicon.ico alt aria-label=logo height=35>~$ cd ..</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title=üîé><span>üîé</span></a></li><li><a href=http://localhost:1313/dotfiles/ title="‚Ä¢ dots"><span>‚Ä¢ dots</span></a></li><li><a href=http://localhost:1313/tags/ title="‚Ä¢ tags"><span>‚Ä¢ tags</span></a></li><li><a href=http://localhost:1313/newsletter title="‚Ä¢ newsletter"><span>‚Ä¢ newsletter</span></a></li><li><a href=http://localhost:1313/posts/ title="‚Ä¢ posts"><span>‚Ä¢ posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks</h1><div class=post-meta></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pregunta aria-label=PREGUNTA>PREGUNTA</a></li><li><a href=#explicaci%c3%b3n aria-label=EXPLICACI√ìN>EXPLICACI√ìN</a></li><li><a href=#ejemplo-real aria-label="EJEMPLO REAL">EJEMPLO REAL</a></li><li><a href=#consejo-clave aria-label="CONSEJO CLAVE">CONSEJO CLAVE</a></li><li><a href=#referencias aria-label=REFERENCIAS>REFERENCIAS</a></li></ul></div></details></div><div class=post-content><p><em><strong>Contexto</strong>: Los sistemas de pago digital procesan millones de transacciones diarias donde un atacante podr√≠a interceptar datos v√°lidos y reutilizarlos para compras fraudulentas. Apple Pay procesa 41 millones de transacciones diarias usando criptogramas din√°micos que previenen estos ataques.</em></p><h3 id=pregunta>PREGUNTA<a hidden class=anchor aria-hidden=true href=#pregunta>#</a></h3><p>Est√°s dise√±ando un sistema de pagos m√≥viles para una plataforma de e-commerce. Durante una revisi√≥n de seguridad, tu equipo identifica que un atacante podr√≠a capturar solicitudes NFC v√°lidas y reproducirlas para realizar compras no autorizadas.</p><p>Necesitas implementar una soluci√≥n que genere pruebas criptogr√°ficas √∫nicas por transacci√≥n.</p><p><strong>¬øCu√°l es la arquitectura m√°s efectiva para prevenir replay attacks manteniendo capacidad offline?</strong></p><p>¬†</p><p>A) Generar un hash SHA-256 del Device Account Number (DAN) y enviarlo en cada transacci√≥n junto con un timestamp del servidor</p><p>B) Crear un criptograma √∫nico combinando DAN + detalles de transacci√≥n (monto, merchant ID) + nonce impredecible, validado matem√°ticamente por la red de pagos</p><p>C) Implementar tokens JWT con expiraci√≥n de 5 minutos firmados con clave sim√©trica compartida entre dispositivo y servidor</p><p>D) Almacenar un contador incremental en el dispositivo que se valida contra una base de datos centralizada en cada transacci√≥n</p><p>¬†</p><p><strong>RESPUESTA: B</strong></p><h3 id=explicaci√≥n>EXPLICACI√ìN<a hidden class=anchor aria-hidden=true href=#explicaci√≥n>#</a></h3><p>La opci√≥n B implementa el patr√≥n de Per-Transaction Cryptographic Signature que Apple Pay utiliza exitosamente.</p><p>El criptograma combina tres elementos cr√≠ticos: el DAN (token espec√≠fico del dispositivo almacenado en Secure Element), detalles de la transacci√≥n (monto, merchant ID) y un nonce impredecible generado por el terminal de punto de venta.</p><p>Esta combinaci√≥n genera una firma criptogr√°fica √∫nica que solo es v√°lida para esa transacci√≥n espec√≠fica.</p><p>La red de pagos regenera el criptograma usando su copia del DAN y los mismos par√°metros; si coinciden, la transacci√≥n es leg√≠tima.</p><p>Si un atacante captura el criptograma e intenta replicarlo, la validaci√≥n falla porque el nonce o el monto habr√°n cambiado.</p><p>Este dise√±o funciona completamente offline porque toda la generaci√≥n criptogr√°fica ocurre localmente en el dispositivo usando claves pre-establecidas</p><p>Las otras opciones tienen vulnerabilidades cr√≠ticas:</p><ul><li>A depende de timestamps del servidor (requiere conectividad, vulnerable a desincronizaci√≥n de relojes) y un simple hash es insuficiente sin elementos √∫nicos por transacci√≥n.</li><li>C requiere conectividad de red para validar JWT y tokens de 5 minutos permiten ventana de replay.</li><li>D necesita acceso constante a base de datos centralizada, eliminando capacidad offline y creando punto √∫nico de falla.</li></ul><h3 id=ejemplo-real>EJEMPLO REAL<a hidden class=anchor aria-hidden=true href=#ejemplo-real>#</a></h3><p>Cuando un usuario tapa su iPhone en el metro de Londres sin conexi√≥n a internet, el Secure Element genera un criptograma combinando el DAN almacenado localmente, los ¬£10 del viaje, el merchant ID del sistema de transporte, y el nonce enviado por el terminal.</p><p>Este criptograma se transmite v√≠a NFC al lector. Posteriormente, cuando el terminal recupera conectividad, env√≠a el criptograma a Visa para validaci√≥n.</p><p>Visa regenera el criptograma usando su copia del DAN y los mismos par√°metros de transacci√≥n; si coinciden matem√°ticamente, aprueba el pago.</p><p>Si un atacante intercept√≥ ese criptograma e intenta reusarlo, la validaci√≥n falla instant√°neamente porque el nonce ha cambiado o el timestamp es obsoleto.</p><h3 id=consejo-clave>CONSEJO CLAVE<a hidden class=anchor aria-hidden=true href=#consejo-clave>#</a></h3><p>En sistemas de alta seguridad, nunca conf√≠es en un solo mecanismo de protecci√≥n. Implementa defensa en profundidad combinando tokenizaci√≥n (reemplazar secretos), aislamiento de hardware (Secure Element para claves), y validaci√≥n criptogr√°fica por transacci√≥n.</p><p>Este enfoque multicapa garantiza que comprometer un componente no expone todo el sistema.</p><p>Para APIs de pago, siempre incluye elementos impredecibles (nonces) y espec√≠ficos de contexto (monto, timestamp) en tus firmas criptogr√°ficas.</p><h3 id=referencias>REFERENCIAS<a hidden class=anchor aria-hidden=true href=#referencias>#</a></h3><ul><li><a href=https://www.frugaltesting.com/blog/is-apple-pay-secure-how-apple-ensures-top-tier-security-for-digital-payments>https://www.frugaltesting.com/blog/is-apple-pay-secure-how-apple-ensures-top-tier-security-for-digital-payments</a> - Frugal Testing - Apple Pay Security Architecture: Tokenization & Dynamic Cryptograms</li><li><a href=https://newsletter.systemdesign.one/p/how-does-apple-pay-work>https://newsletter.systemdesign.one/p/how-does-apple-pay-work</a> - System Design Newsletter - How Apple Pay Handles 41 Million Transactions Securely</li><li><a href=https://docs.nuvei.com/documentation/features/network-tokenization/>https://docs.nuvei.com/documentation/features/network-tokenization/</a> - Nuvei Documentation - Network Tokenization & Cryptogram Requirements</li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/q-dead-letter-pipelines-prod/><span class=title>¬´ Prev</span><br><span>Pregunta #8 - Dead-Letter Queue en Pipelines de Producci√≥n</span>
</a><a class=next href=http://localhost:1313/posts/q-procesos-threads-arqs-alta-concurrencia/><span class=title>Next ¬ª</span><br><span>Pregunta #10 Procesos vs Threads en Arquitecturas de Alta Concurrencia</span></a></nav><div id=cusdis_thread data-host=https://cusdis.com data-app-id=f9b750aa-55fe-4da9-82cf-45aa511cea20 data-app-id=414adb98-9af8-4403-bdc5-ba55ae808bea data-page-id=24573e47e56496d9542c83bbd838f650 data-page-url=http://localhost:1313/posts/q-criptogramas-prevencion-replay-attacks/ data-page-title="Pregunta #9 - Criptogramas Din√°micos para Prevenci√≥n de Replay Attacks"></div><script async defer src=https://cusdis.com/js/cusdis.es.js></script></footer></article></main><script async defer src=https://scripts.withcabin.com/hello.js></script></body></html>