<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Pregunta #7 - Arquitectura Medallion en Data Lakehouse | Omar Valdez G</title><meta name=keywords content="medallion,architecture,lakehouse"><meta name=description content="Bronze, Silver y Gold en Google Cloud"><meta name=author content="Omar Valdez G"><link rel=canonical href=http://localhost:1313/posts/q-arquitectura-medallion-warehouse/><link crossorigin=anonymous href=/assets/css/stylesheet.d8bb4da40dcec890935558078b7b18d1baf46e84a80ea4cc9702a8734954dbff.css integrity="sha256-2LtNpA3OyJCTVVgHi3sY0br0boSoDqTMlwKoc0lU2/8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/q-arquitectura-medallion-warehouse/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet><script src=https://unpkg.com/typeit@8.7.1/dist/index.umd.js></script><style>body{font-family:iosevka nerd font bold,monospace}</style><meta property="og:title" content="Pregunta #7 - Arquitectura Medallion en Data Lakehouse"><meta property="og:description" content="Bronze, Silver y Gold en Google Cloud"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/q-arquitectura-medallion-warehouse/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-25T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-25T00:00:00+00:00"><meta property="og:site_name" content="Omar Valdez G"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pregunta #7 - Arquitectura Medallion en Data Lakehouse"><meta name=twitter:description content="Bronze, Silver y Gold en Google Cloud"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Pregunta #7 - Arquitectura Medallion en Data Lakehouse","item":"http://localhost:1313/posts/q-arquitectura-medallion-warehouse/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Pregunta #7 - Arquitectura Medallion en Data Lakehouse","name":"Pregunta #7 - Arquitectura Medallion en Data Lakehouse","description":"Bronze, Silver y Gold en Google Cloud","keywords":["medallion","architecture","lakehouse"],"articleBody":"Contexto: La arquitectura medallion organiza datos en capas progresivas de refinamiento (Bronze, Silver, Gold), separando almacenamiento econ√≥mico en GCS del c√≥mputo especializado en BigQuery o Spark. Esta estructura permite servir diferentes casos de uso simult√°neamente: desde exploraci√≥n de datos crudos hasta inteligencia de negocio pulida.\nPREGUNTA Tu equipo implementa un data lakehouse en Google Cloud Platform para soportar m√∫ltiples consumidores: ingenieros de datos que necesitan reprocesar datos hist√≥ricos, cient√≠ficos de datos construyendo modelos de machine learning, y ejecutivos consultando dashboards en Looker.\nEl pipeline ingesta eventos de aplicaciones m√≥viles en formato JSON con campos anidados, algunos registros duplicados y timestamps inconsistentes.\nDespu√©s de validaci√≥n y limpieza, los datos alimentan agregaciones diarias para reportes de producto.\nEl equipo debate d√≥nde almacenar cada versi√≥n de los datos y qu√© herramientas usar para transformaci√≥n.\n¬øCu√°l arquitectura cumple mejor con estos requisitos manteniendo costo-eficiencia y flexibilidad operacional?\nA) Almacenar todo en BigQuery usando tablas nativas; ejecutar limpieza con SQL scheduled queries; crear vistas materializadas para agregaciones; todos los usuarios consultan las mismas tablas\nB) Ingestar JSON crudo a GCS (Bronze); usar Spark en Dataproc para limpiar y validar hacia GCS (Silver) en Parquet; cargar agregaciones a BigQuery (Gold); cient√≠ficos acceden Silver, ejecutivos Gold\nC) Cargar JSON directamente a MongoDB para queries operacionales; replicar a BigQuery usando CDC; ejecutar todas las transformaciones en dbt; mantener una sola copia final\nD) Procesar todo en Dataflow streaming antes de almacenar; escribir √∫nicamente la versi√≥n final limpia y agregada a BigQuery; eliminar datos crudos para ahorrar costos\nRESPUESTA: B\nEXPLICACI√ìN La opci√≥n B implementa correctamente la arquitectura medallion con separaci√≥n de storage y compute. Bronze (GCS con JSON crudo) preserva el estado original para reprocessamiento futuro, cumpliendo requisitos de auditor√≠a y debugging.\nSilver (Parquet limpio en GCS) proporciona datos validados y sin duplicados para cient√≠ficos de datos que necesitan granularidad completa para modelos ML.\nGold (agregaciones en BigQuery) optimiza consultas anal√≠ticas para dashboards ejecutivos con latencia sub-segundo.\nSpark maneja transformaciones complejas (JSON anidado, deduplicaci√≥n) que superan capacidades SQL, mientras BigQuery ejecuta agregaciones aprovechando su motor columnar.\nLas opciones A, C y D fallan porque:\nA mezcla datos crudos y limpios sin separaci√≥n clara, incrementando confusi√≥n y costos de almacenamiento en BigQuery para datos no consultados frecuentemente. C introduce dependencia innecesaria de MongoDB sin justificaci√≥n operacional y pierde capacidad de replay desde datos originales. D elimina la capa Bronze, imposibilitando correcciones retroactivas cuando se descubren errores de l√≥gica de negocio. EJEMPLO REAL Una plataforma de e-commerce implement√≥ esta arquitectura: Bronze almacena 500TB de eventos JSON en GCS ($10K/mes), Silver contiene 150TB de Parquet limpio accesible por 20 cient√≠ficos de datos en Vertex AI, y Gold mantiene 5TB de agregaciones en BigQuery sirviendo 1000+ usuarios concurrentes en Looker.\nEl costo de queries en Gold es 60% menor que consultar Bronze directamente debido a pre-agregaci√≥n. Cuando detectaron un error en c√°lculo de conversi√≥n, reprocesaron Bronze completo en 6 horas sin impactar producci√≥n.\nCONSEJO CLAVE Implementa separaci√≥n f√≠sica desde el inicio: usa buckets o prefijos distintos en GCS para Bronze/Silver/Gold.\nEsto simplifica control de acceso (data engineers a Bronze, data scientists a Silver, analistas a Gold) y pol√≠ticas de retenci√≥n diferenciadas (Ejemplo: Bronze 7 a√±os para compliance, Gold 90 d√≠as por volumen reducido).\nMonitorea que Gold consuma menos storage que Silver‚Äîsi no ocurre, tus agregaciones son insuficientes.\nREFERENCIAS What is Medallion architecture in a Data Lakehouse context? - Bismart Medallion Architecture 101: How the Three Layers Work - ChaosGenius ETL vs ELT vs EtLT: Choosing the right data pipeline for Google Cloud - LinkedIn ","wordCount":"582","inLanguage":"en","datePublished":"2025-11-25T00:00:00Z","dateModified":"2025-11-25T00:00:00Z","author":{"@type":"Person","name":"Omar Valdez G"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/q-arquitectura-medallion-warehouse/"},"publisher":{"@type":"Organization","name":"Omar Valdez G","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="~$ cd .. (Alt + H)"><img src=http://localhost:1313/favicon/favicon.ico alt aria-label=logo height=35>~$ cd ..</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title=üîé><span>üîé</span></a></li><li><a href=http://localhost:1313/dotfiles/ title="‚Ä¢ dots"><span>‚Ä¢ dots</span></a></li><li><a href=http://localhost:1313/tags/ title="‚Ä¢ tags"><span>‚Ä¢ tags</span></a></li><li><a href=http://localhost:1313/newsletter title="‚Ä¢ newsletter"><span>‚Ä¢ newsletter</span></a></li><li><a href=http://localhost:1313/posts/ title="‚Ä¢ posts"><span>‚Ä¢ posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Pregunta #7 - Arquitectura Medallion en Data Lakehouse</h1><div class=post-meta></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pregunta aria-label=PREGUNTA>PREGUNTA</a></li><li><a href=#explicaci%c3%b3n aria-label=EXPLICACI√ìN>EXPLICACI√ìN</a></li><li><a href=#ejemplo-real aria-label="EJEMPLO REAL">EJEMPLO REAL</a></li><li><a href=#consejo-clave aria-label="CONSEJO CLAVE">CONSEJO CLAVE</a></li><li><a href=#referencias aria-label=REFERENCIAS>REFERENCIAS</a></li></ul></div></details></div><div class=post-content><p><em><strong>Contexto</strong>: La arquitectura medallion organiza datos en capas progresivas de refinamiento (Bronze, Silver, Gold), separando almacenamiento econ√≥mico en GCS del c√≥mputo especializado en BigQuery o Spark. Esta estructura permite servir diferentes casos de uso simult√°neamente: desde exploraci√≥n de datos crudos hasta inteligencia de negocio pulida.</em></p><h3 id=pregunta>PREGUNTA<a hidden class=anchor aria-hidden=true href=#pregunta>#</a></h3><p>Tu equipo implementa un data lakehouse en Google Cloud Platform para soportar m√∫ltiples consumidores: ingenieros de datos que necesitan reprocesar datos hist√≥ricos, cient√≠ficos de datos construyendo modelos de machine learning, y ejecutivos consultando dashboards en Looker.</p><p>El pipeline ingesta eventos de aplicaciones m√≥viles en formato JSON con campos anidados, algunos registros duplicados y timestamps inconsistentes.</p><p>Despu√©s de validaci√≥n y limpieza, los datos alimentan agregaciones diarias para reportes de producto.</p><p>El equipo debate d√≥nde almacenar cada versi√≥n de los datos y qu√© herramientas usar para transformaci√≥n.</p><p><strong>¬øCu√°l arquitectura cumple mejor con estos requisitos manteniendo costo-eficiencia y flexibilidad operacional?</strong></p><p>¬†</p><p>A) Almacenar todo en BigQuery usando tablas nativas; ejecutar limpieza con SQL scheduled queries; crear vistas materializadas para agregaciones; todos los usuarios consultan las mismas tablas</p><p>B) Ingestar JSON crudo a GCS (Bronze); usar Spark en Dataproc para limpiar y validar hacia GCS (Silver) en Parquet; cargar agregaciones a BigQuery (Gold); cient√≠ficos acceden Silver, ejecutivos Gold</p><p>C) Cargar JSON directamente a MongoDB para queries operacionales; replicar a BigQuery usando CDC; ejecutar todas las transformaciones en dbt; mantener una sola copia final</p><p>D) Procesar todo en Dataflow streaming antes de almacenar; escribir √∫nicamente la versi√≥n final limpia y agregada a BigQuery; eliminar datos crudos para ahorrar costos</p><p>¬†</p><p><strong>RESPUESTA: B</strong></p><h3 id=explicaci√≥n>EXPLICACI√ìN<a hidden class=anchor aria-hidden=true href=#explicaci√≥n>#</a></h3><p>La opci√≥n B implementa correctamente la arquitectura medallion con separaci√≥n de storage y compute. Bronze (GCS con JSON crudo) preserva el estado original para reprocessamiento futuro, cumpliendo requisitos de auditor√≠a y debugging.</p><p>Silver (Parquet limpio en GCS) proporciona datos validados y sin duplicados para cient√≠ficos de datos que necesitan granularidad completa para modelos ML.</p><p>Gold (agregaciones en BigQuery) optimiza consultas anal√≠ticas para dashboards ejecutivos con latencia sub-segundo.</p><p>Spark maneja transformaciones complejas (JSON anidado, deduplicaci√≥n) que superan capacidades SQL, mientras BigQuery ejecuta agregaciones aprovechando su motor columnar.</p><p>Las opciones A, C y D fallan porque:</p><ul><li>A mezcla datos crudos y limpios sin separaci√≥n clara, incrementando confusi√≥n y costos de almacenamiento en BigQuery para datos no consultados frecuentemente.</li><li>C introduce dependencia innecesaria de MongoDB sin justificaci√≥n operacional y pierde capacidad de replay desde datos originales.</li><li>D elimina la capa Bronze, imposibilitando correcciones retroactivas cuando se descubren errores de l√≥gica de negocio.</li></ul><h3 id=ejemplo-real>EJEMPLO REAL<a hidden class=anchor aria-hidden=true href=#ejemplo-real>#</a></h3><p>Una plataforma de e-commerce implement√≥ esta arquitectura: Bronze almacena 500TB de eventos JSON en GCS ($10K/mes), Silver contiene 150TB de Parquet limpio accesible por 20 cient√≠ficos de datos en Vertex AI, y Gold mantiene 5TB de agregaciones en BigQuery sirviendo 1000+ usuarios concurrentes en Looker.</p><p>El costo de queries en Gold es 60% menor que consultar Bronze directamente debido a pre-agregaci√≥n. Cuando detectaron un error en c√°lculo de conversi√≥n, reprocesaron Bronze completo en 6 horas sin impactar producci√≥n.</p><h3 id=consejo-clave>CONSEJO CLAVE<a hidden class=anchor aria-hidden=true href=#consejo-clave>#</a></h3><p>Implementa separaci√≥n f√≠sica desde el inicio: usa buckets o prefijos distintos en GCS para Bronze/Silver/Gold.</p><p>Esto simplifica control de acceso (data engineers a Bronze, data scientists a Silver, analistas a Gold) y pol√≠ticas de retenci√≥n diferenciadas (Ejemplo: Bronze 7 a√±os para compliance, Gold 90 d√≠as por volumen reducido).</p><p>Monitorea que Gold consuma menos storage que Silver‚Äîsi no ocurre, tus agregaciones son insuficientes.</p><h3 id=referencias>REFERENCIAS<a hidden class=anchor aria-hidden=true href=#referencias>#</a></h3><ul><li><a href=https://blog.bismart.com/en/medallion-architecture>What is Medallion architecture in a Data Lakehouse context? - Bismart</a></li><li><a href=https://www.chaosgenius.io/blog/medallion-architecture/>Medallion Architecture 101: How the Three Layers Work - ChaosGenius</a></li><li><a href=https://www.linkedin.com/posts/gouthami-r-982075307_data-on-google-cloud-etl-vs-elt-vs-etlt-activity-7373924431926231040-Jepo/>ETL vs ELT vs EtLT: Choosing the right data pipeline for Google Cloud - LinkedIn</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/medallion/>Medallion</a></li><li><a href=http://localhost:1313/tags/architecture/>Architecture</a></li><li><a href=http://localhost:1313/tags/lakehouse/>Lakehouse</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/q-tokenizacion-llms-multilinguies/><span class=title>¬´ Prev</span><br><span>Pregunta #6 - Tokenizaci√≥n en LLMs Multiling√ºes</span>
</a><a class=next href=http://localhost:1313/posts/q-dead-letter-pipelines-prod/><span class=title>Next ¬ª</span><br><span>Pregunta #8 - Dead-Letter Queue en Pipelines de Producci√≥n</span></a></nav><div id=cusdis_thread data-host=https://cusdis.com data-app-id=f9b750aa-55fe-4da9-82cf-45aa511cea20 data-app-id=414adb98-9af8-4403-bdc5-ba55ae808bea data-page-id=52e025f1d16e0d2fc2dad73bc9c60fda data-page-url=http://localhost:1313/posts/q-arquitectura-medallion-warehouse/ data-page-title="Pregunta #7 - Arquitectura Medallion en Data Lakehouse"></div><script async defer src=https://cusdis.com/js/cusdis.es.js></script></footer></article></main><script async defer src=https://scripts.withcabin.com/hello.js></script></body></html>